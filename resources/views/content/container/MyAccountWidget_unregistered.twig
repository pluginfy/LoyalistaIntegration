<h2>Bonusprogramm (my account page)</h2>
<style>

    .label {
        background-color: #fff;
        text-align: left;
        color: #000;
        display: inline-block;
        cursor: pointer;
    }

    div.widget-myaccount{
        margin-top: 15px;
        margin-bottom: 15px;
        border: 1px solid #666;
        padding: 5px;
    }

</style>

<div class = "widget-myaccount">
    <label class="label">
        <input id="yes_rgisistered_loyalista_programme" type="checkbox" value="text">  {{ offer }}
    </label>
    <button class="btn  btn-primary btn-appearance" onclick="register_me(this)"> {{ btn_label }}</button>
</div>

<script>

    function register_me(_obj) {
        $(_obj).attr('disabled' , true);

        let checked = $('#yes_rgisistered_loyalista_programme').is(":checked");

        if(!checked){
            $(_obj).attr('disabled' , false);
            return false;
        }

        $.ajax({
            url: '/account/register/customer/',
            type: "GET",
            data: {},
            dataType: "json",
            cache: true
        }).done(function (return_data) {
            try {
                var data;
                if (typeof return_data === 'object') data = return_data;
                else data = $.parseJSON(return_data);
                if (data.status === "OK") {
                    location.reload();
                } else {
                    $(_obj).attr('disabled' , false);
                    alert(data.message);
                }
            } catch (error) {
                console.log(error);
                $(_obj).attr('disabled' , false);
            }
        }).fail(function (data) {
            $(_obj).attr('disabled' , false);
        });
    }


</script>